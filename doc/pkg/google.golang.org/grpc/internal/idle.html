<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Package: google.golang.org/grpc/internal/idle</title>
<link href="../../../../css/auto-v0.7.6.css" rel="stylesheet">
<script src="../../../../jvs/golds-v0.7.6.js"></script>
<body onload="onPageLoad()"><div>

<pre id="package-details"><code><span style="font-size:xx-large;">package <b>idle</b></span>

<span class="title">Import Path</span>
	<a href="../../../../index.html#pkg-google.golang.org/grpc/internal/idle">google.golang.org/grpc/internal/idle</a><i> (on <a href="https://pkg.go.dev/google.golang.org/grpc/internal/idle" target="_blank">go.dev</a>)</i>

<span class="title">Dependency Relation</span>
	imports <a href="../../../../dep/google.golang.org/grpc/internal/idle.html">5 packages</a>, and imported by <a href="../../../../dep/google.golang.org/grpc/internal/idle.html#imported-by">one package</a>

<div id="files"><span class="title">Involved Source Files</span>

	<input type='checkbox' checked class="fold" id="file-0-fold-content"><label for="file-0-fold-content">  <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#doc">d</a> <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html">idle.go</a></label><span id='file-0-fold-content-items' class="fold-items">
<span class="md-text">		Package idle contains a component for managing idleness (entering and exiting)
		based on RPC activity.</span></span></div>
<div id="exported-types"><span class="title">Package-Level Type Names<span class="title-stat"><i> (total 2, both are exported)</i></span></span>

<div id="exported-types-buttons" class="js-on">	/* sort exporteds by: <label id="sort-types-by-alphabet" class="button">alphabet</label> | <label id="sort-types-by-popularity" class="button">popularity</label> */</div><div class="anchor type-res" id="name-Enforcer" data-popularity="285">	<input type='checkbox' class="fold" id="Enforcer-fold-content"><label for="Enforcer-fold-content"> <a href="../../../../use/google.golang.org/grpc/internal/idle..Enforcer.html">type</a> <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-38">Enforcer</a> <b><i>(interface)</i></b></label><span id='Enforcer-fold-content-docs' class="fold-docs">
<span class="md-text">		Enforcer is the functionality provided by grpc.ClientConn to enter
		and exit from idle mode.</span>

		<input type='checkbox' class="fold" id="Enforcer-fold-methods"><label for="Enforcer-fold-methods">Methods (<i>total 2, both are exported</i>)</label><span id='Enforcer-fold-methods-items' class="fold-items"><span>
			<span class="nodocs">( Enforcer) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-40">EnterIdleMode</a>()</span></span><span>
			<span class="nodocs">( Enforcer) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-39">ExitIdleMode</a>() <a href="../../../builtin.html#name-error">error</a></span></span></span>
		<input type='checkbox' class="fold" id="Enforcer-fold-impledby"><label for="Enforcer-fold-impledby">Implemented By (<i>at least one unexported</i>)</label><span id='Enforcer-fold-impledby-items' class="fold-items">
			<input type='checkbox' class="showhide" id="Enforcer-showhide-impedBys"><i><label for="Enforcer-showhide-impedBys" class="show-inline">/* at least one unexported ... */</label><label for="Enforcer-showhide-impedBys" class="hide-inline">/* at least one unexported: */</label></i><span class="hidden"><i>
			*google.golang.org/grpc.<a href="../../grpc.html#name-idler">idler</a></i></span></span>
		<input type='checkbox' class="fold" id="Enforcer-fold-params"><label for="Enforcer-fold-params">As Inputs Of (<i>at least one exported</i>)</label><span id='Enforcer-fold-params-items' class="fold-items"><span>
			func <a href="#name-NewManager">NewManager</a>(enforcer <b>Enforcer</b>, timeout <a href="../../../time.html">time</a>.<a href="../../../time.html#name-Duration">Duration</a>) *<a href="#name-Manager">Manager</a></span></span>

</span></div><div class="anchor type-res" id="name-Manager" data-popularity="575">	<input type='checkbox' class="fold" id="Manager-fold-content"><label for="Manager-fold-content"> <a href="../../../../use/google.golang.org/grpc/internal/idle..Manager.html">type</a> <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-45">Manager</a> <i>(struct)</i></label><span id='Manager-fold-content-docs' class="fold-docs">
<span class="md-text">		Manager implements idleness detection and calls the configured Enforcer to
		enter/exit idle mode when appropriate.  Must be created by NewManager.</span>

		<input type='checkbox' class="fold" id="Manager-fold-fields"><label for="Manager-fold-fields">Fields (<i>total 9, none are exported</i>)</label><span id='Manager-fold-fields-items' class="fold-items">
			<input type='checkbox' class="showhide" id="Manager-showhide-fields"><i><label for="Manager-showhide-fields" class="show-inline">/* 9 unexporteds ... */</label><label for="Manager-showhide-fields" class="hide-inline">/* 9 unexporteds: */</label></i><span class="hidden"><i>
			<input type='checkbox' class="fold" id="Manager-fold-field-activeCallsCount"><label for="Manager-fold-field-activeCallsCount"><a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-48">activeCallsCount</a> <i><a href="../../../builtin.html#name-int32">int32</a></i></label><span id='Manager-fold-field-activeCallsCount-docs' class="fold-docs">
<span class="md-text">				// Count of active RPCs; -math.MaxInt32 means channel is idle or is trying to get there.</span>
</span></i></span><span class="hidden"><i>
			<input type='checkbox' class="fold" id="Manager-fold-field-activeSinceLastTimerCheck"><label for="Manager-fold-field-activeSinceLastTimerCheck"><a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-49">activeSinceLastTimerCheck</a> <i><a href="../../../builtin.html#name-int32">int32</a></i></label><span id='Manager-fold-field-activeSinceLastTimerCheck-docs' class="fold-docs">
<span class="md-text">				// Boolean; True if there was an RPC since the last timer callback.</span>
</span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-69">actuallyIdle</a> <i><a href="../../../builtin.html#name-bool">bool</a></i></span></i></span><span class="hidden"><i>
			<input type='checkbox' class="fold" id="Manager-fold-field-closed"><label for="Manager-fold-field-closed"><a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-50">closed</a> <i><a href="../../../builtin.html#name-int32">int32</a></i></label><span id='Manager-fold-field-closed-docs' class="fold-docs">
<span class="md-text">				// Boolean; True when the manager is closed.</span>
</span></i></span><span class="hidden"><i>
			<input type='checkbox' class="fold" id="Manager-fold-field-enforcer"><label for="Manager-fold-field-enforcer"><a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-54">enforcer</a> <i><a href="#name-Enforcer">Enforcer</a></i></label><span id='Manager-fold-field-enforcer-docs' class="fold-docs">
<span class="md-text">				Can be accessed without atomics or mutex since these are set at creation
				time and read-only after that.</span>
<span class="md-text">				// Functionality provided by grpc.ClientConn.</span>
</span></i></span><span class="hidden"><i>
			<input type='checkbox' class="fold" id="Manager-fold-field-idleMu"><label for="Manager-fold-field-idleMu"><a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-68">idleMu</a> <i><a href="../../../sync.html">sync</a>.<a href="../../../sync.html#name-RWMutex">RWMutex</a></i></label><span id='Manager-fold-field-idleMu-docs' class="fold-docs">
<span class="md-text">				idleMu is used to guarantee mutual exclusion in two scenarios:
				- Opposing intentions:
				  - a: Idle timeout has fired and handleIdleTimeout() is trying to put
				    the channel in idle mode because the channel has been inactive.
				  - b: At the same time an RPC is made on the channel, and OnCallBegin()
				    is trying to prevent the channel from going idle.
				- Competing intentions:
				  - The channel is in idle mode and there are multiple RPCs starting at
				    the same time, all trying to move the channel out of idle. Only one
				    of them should succeed in doing so, while the other RPCs should
				    piggyback on the first one and be successfully handled.</span>
</span></i></span><span class="hidden"><i>
			<input type='checkbox' class="fold" id="Manager-fold-field-lastCallEndTime"><label for="Manager-fold-field-lastCallEndTime"><a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-47">lastCallEndTime</a> <i><a href="../../../builtin.html#name-int64">int64</a></i></label><span id='Manager-fold-field-lastCallEndTime-docs' class="fold-docs">
<span class="md-text">				State accessed atomically.</span>
<span class="md-text">				// Unix timestamp in nanos; time when the most recent RPC completed.</span>
</span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-55">timeout</a> <i><a href="../../../time.html">time</a>.<a href="../../../time.html#name-Duration">Duration</a></i></span></i></span><span class="hidden"><i>
			<span class="nodocs"><a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-70">timer</a> <i>*<a href="../../../time.html">time</a>.<a href="../../../time.html#name-Timer">Timer</a></i></span></i></span></span>
		<input type='checkbox' class="fold" id="Manager-fold-methods"><label for="Manager-fold-methods">Methods (<i>total 10, in which 5 are exported</i>)</label><span id='Manager-fold-methods-items' class="fold-items"><span>
			<input type='checkbox' class="fold" id="Manager-fold-method-Close"><label for="Manager-fold-method-Close">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-271">Close</a>()</label><span id='Manager-fold-method-Close-docs' class="fold-docs">
<span class="md-text">				Close stops the timer associated with the Manager, if it exists.</span>
</span></span><span>
			<input type='checkbox' class="fold" id="Manager-fold-method-EnterIdleModeForTesting"><label for="Manager-fold-method-EnterIdleModeForTesting">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-186">EnterIdleModeForTesting</a>()</label><span id='Manager-fold-method-EnterIdleModeForTesting-docs' class="fold-docs">
<span class="md-text">				EnterIdleModeForTesting instructs the channel to enter idle mode.</span>
</span></span><span>
			<input type='checkbox' class="fold" id="Manager-fold-method-ExitIdleMode"><label for="Manager-fold-method-ExitIdleMode">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-217">ExitIdleMode</a>() <a href="../../../builtin.html#name-error">error</a></label><span id='Manager-fold-method-ExitIdleMode-docs' class="fold-docs">
<span class="md-text">				ExitIdleMode instructs m to call the enforcer's ExitIdleMode and update m's
				internal state.</span>
</span></span><span>
			<input type='checkbox' class="fold" id="Manager-fold-method-OnCallBegin"><label for="Manager-fold-method-OnCallBegin">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-191">OnCallBegin</a>() <a href="../../../builtin.html#name-error">error</a></label><span id='Manager-fold-method-OnCallBegin-docs' class="fold-docs">
<span class="md-text">				OnCallBegin is invoked at the start of every RPC.</span>
</span></span><span>
			<input type='checkbox' class="fold" id="Manager-fold-method-OnCallEnd"><label for="Manager-fold-method-OnCallEnd">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-251">OnCallEnd</a>()</label><span id='Manager-fold-method-OnCallEnd-docs' class="fold-docs">
<span class="md-text">				OnCallEnd is invoked at the end of every RPC.</span>
</span></span>
			<input type='checkbox' class="showhide" id="Manager-showhide-methods"><i><label for="Manager-showhide-methods" class="show-inline">/* 5 unexporteds ... */</label><label for="Manager-showhide-methods" class="hide-inline">/* 5 unexporteds: */</label></i><span class="hidden"><i>
			<input type='checkbox' class="fold" id="Manager-fold-method-handleIdleTimeout"><label for="Manager-fold-method-handleIdleTimeout">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-108">handleIdleTimeout</a>()</label><span id='Manager-fold-method-handleIdleTimeout-docs' class="fold-docs">
<span class="md-text">				handleIdleTimeout is the timer callback that is invoked upon expiry of the
				configured idle timeout. The channel is considered inactive if there are no
				ongoing calls and no RPC activity since the last time the timer fired.</span>
</span></i></span><span class="hidden"><i>
			<span class="nodocs">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-266">isClosed</a>() <a href="../../../builtin.html#name-bool">bool</a></span></i></span><span class="hidden"><i>
			<span class="nodocs">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-99">resetIdleTimer</a>(d <a href="../../../time.html">time</a>.<a href="../../../time.html#name-Duration">Duration</a>)</span></i></span><span class="hidden"><i>
			<input type='checkbox' class="fold" id="Manager-fold-method-resetIdleTimerLocked"><label for="Manager-fold-method-resetIdleTimerLocked">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-86">resetIdleTimerLocked</a>(d <a href="../../../time.html">time</a>.<a href="../../../time.html#name-Duration">Duration</a>)</label><span id='Manager-fold-method-resetIdleTimerLocked-docs' class="fold-docs">
<span class="md-text">				resetIdleTimerLocked resets the idle timer to the given duration.  Called
				when exiting idle mode or when the timer fires and we need to reset it.</span>
</span></i></span><span class="hidden"><i>
			<input type='checkbox' class="fold" id="Manager-fold-method-tryEnterIdleMode"><label for="Manager-fold-method-tryEnterIdleMode">(*Manager) <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-148">tryEnterIdleMode</a>() <a href="../../../builtin.html#name-bool">bool</a></label><span id='Manager-fold-method-tryEnterIdleMode-docs' class="fold-docs">
<span class="md-text">				tryEnterIdleMode instructs the channel to enter idle mode. But before
				that, it performs a last minute check to ensure that no new RPC has come in,
				making the channel active.
				
				Return value indicates whether or not the channel moved to idle mode.
				
				Holds idleMu which ensures mutual exclusion with exitIdleMode.</span>
</span></i></span></span>
		<input type='checkbox' class="fold" id="Manager-fold-results"><label for="Manager-fold-results">As Outputs Of (<i>at least one exported</i>)</label><span id='Manager-fold-results-items' class="fold-items"><span>
			func <a href="#name-NewManager">NewManager</a>(enforcer <a href="#name-Enforcer">Enforcer</a>, timeout <a href="../../../time.html">time</a>.<a href="../../../time.html#name-Duration">Duration</a>) *<b>Manager</b></span></span>

</span></div></div>
<div id="exported-functions"><span class="title">Package-Level Functions<span class="title-stat"><i> (only one, which is exported)</i></span></span>

<div class="anchor value-res" id="name-NewManager">	<input type='checkbox' class="fold" id="NewManager-fold-content"><label for="NewManager-fold-content"> <a href="../../../../use/google.golang.org/grpc/internal/idle..NewManager.html">func</a> <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-75">NewManager</a>(enforcer <a href="#name-Enforcer">Enforcer</a>, timeout <a href="../../../time.html">time</a>.<a href="../../../time.html#name-Duration">Duration</a>) *<a href="#name-Manager">Manager</a></label><span id='NewManager-fold-content-docs' class="fold-docs">
<span class="md-text">		NewManager creates a new idleness manager implementation for the
		given idle timeout.  It begins in idle mode.</span>

</span></div></div>
<div id="exported-variables"><span class="title">Package-Level Variables<span class="title-stat"><i> (only one, which is unexported)</i></span></span>

	<input type='checkbox' class="showhide" id="unexported-variables-showhide"><i><label for="unexported-variables-showhide" class="show-inline">/* one unexported ... */</label><label for="unexported-variables-showhide" class="hide-inline">/* one unexported: */</label></i><div class="anchor value-res hidden" id="name-timeAfterFunc"><i>	<input type='checkbox' class="fold" id="timeAfterFunc-fold-content"><label for="timeAfterFunc-fold-content">  <a href="../../../../use/google.golang.org/grpc/internal/idle..timeAfterFunc^3f183.html">var</a> <a href="../../../../src/google.golang.org/grpc/internal/idle/idle.go.html#line-32">timeAfterFunc</a> func(d <a href="../../../time.html">time</a>.<a href="../../../time.html#name-Duration">Duration</a>, f func()) *<a href="../../../time.html">time</a>.<a href="../../../time.html#name-Timer">Timer</a></label><span id='timeAfterFunc-fold-content-docs' class="fold-docs">
<span class="md-text">		For overriding in unit tests.</span>

</span></i></div></div></code></pre><pre id="footer">
The pages are generated with <a href="https://go101.org/apps-and-libs/golds.html"><b>Golds</b></a> <i>v0.7.6</i>. (GOOS=linux GOARCH=amd64)</pre>